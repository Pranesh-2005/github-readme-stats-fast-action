name: GitHub Readme Stats Action
description: Generate GitHub Readme Stats cards in GitHub Actions.
author: readme-tools

inputs:
  card:
    description: Card type to generate (stats, top-langs, pin, wakatime, gist).
    required: true
  options:
    description: Options for the card (query string or JSON).
    required: false
    default: ""
  path:
    description: Output path for SVG file (relative path; include filename with .svg).
    required: false
    default: ""
  token:
    description: GitHub token (PAT or GITHUB_TOKEN).
    required: false
    default: ""

outputs:
  path:
    description: Path where the SVG file was written.

runs:
  using: composite
  steps:
    # ‚úÖ ADD: pnpm setup
    - name: Setup pnpm
      uses: pnpm/action-setup@v4
      with:
        version: 9

    # ‚úÖ ADD: node setup (required for pnpm cache)
    - name: Setup Node
      uses: actions/setup-node@v4
      with:
        node-version: 22
        cache: pnpm

    # üîÅ REPLACED npm ci ‚Üí pnpm install
    - name: Install dependencies
      run: pnpm install --prod --frozen-lockfile
      shell: bash
      working-directory: ${{ github.action_path }}

    # ‚õî unchanged
    - name: Generate card
      run: node ${{ github.action_path }}/index.js
      shell: bash
      env:
        INPUT_CARD: ${{ inputs.card }}
        INPUT_OPTIONS: ${{ inputs.options }}
        INPUT_PATH: ${{ inputs.path }}
        PAT_1: ${{ inputs.token || github.token }}

branding:
  icon: bar-chart-2
  color: blue        PAT_1: ${{ inputs.token || github.token }}
branding:
  icon: bar-chart-2
  color: blue
